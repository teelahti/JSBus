var JSBus;(function(n){var t=function(){function t(t,i,r){var u=this;this.sendTransport=i,this.subscribeTransport=r,this.store=new n.LocalStorageStore,this.pending=[],this.sendTimer=0,this.store.containerName=t,this.subscribeTransport.ack(function(n){return u.store.ack(n)})}return t.prototype.send=function(n){n&&(n.id||(n.id=(new Date).getTime()),this.store.add(n),this.sendTimer||this.sendMessages())},t.prototype.subscribe=function(n,i){if(!t.isFunc(n))throw new Error("Given subscribe callback must be a function");if(!t.isFunc(i)){var r=i;i=function(n){return!i||n.Name===r||n.name===r}}this.subscribeTransport.receive(function(t){i(t)&&n(t)})},t.prototype.sendMessages=function(){var n=this;this.store.sendAll(function(t){return n.sendTransport.send(t)}),this.sendTimer=setTimeout(this.sendMessages.bind(this),100)},t.isFunc=function(n){return typeof n=="function"},t}();n.Bus=t})(JSBus||(JSBus={}))